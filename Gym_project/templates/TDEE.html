<!DOCTYPE html>
<html lang="eng">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="wide=device-width,initial-scale=1.0">
    <title>Gym calculator</title>
    </head>
    <style>
        body{
            font-size: medium;
            font-family:'Lucida Sans', 'Lucida Sans Regular', 'Lucida Grande', 'Lucida Sans Unicode', Geneva, Verdana, sans-serif;
            font-weight: 100;
            margin: 0; padding: 0;
            min-height: 100vh;
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            background-color: rgb(228, 246, 240);
        }
        
        ul {
            background: #e3f6f5;
            border-radius: 10px;
            padding: 20px 30px 20px 40px;
            margin: 40px 0;
            box-shadow: 0 2px 8px rgba(0,0,0,0.07);
            max-width: 500px;
            text-align: center;

        }
        li {
            font-size: 1.08em;
            color: #222;
            background: #f7fafc;
            margin-bottom: 10px;
            padding: 10px 18px;
            border-radius: 6px;
            box-shadow: 0 1px 3px rgba(0,0,0,0.04);
            font-family: 'Segoe UI', Verdana, Geneva, Tahoma, sans-serif;
            font-style: normal;
            transition: background 0.2s;
            max-width: 600px;
        }

        li:hover {
            background: #b2f7ef;
        }
        .result_container {
            background: rgb(255, 255, 255);
            padding: 20px;
            border-radius: 10px;
            width: 90%;
            max-width: 600px;
            box-shadow: 0 4px 12px rgba(0,0,0,.1);
            margin-bottom: 20px;
        }
        .result_container h2 {
            text-align: center;
            margin-bottom: 5px;
        } 
        .mode_container{
            background: rgb(255, 255, 255);
            padding: 20px;
            border-radius: 10px;
            width: 90%;
            max-width: 600px;
            box-shadow: 0 4px 12px rgba(0,0,0,.1);
            margin-bottom: 20px;
        }
        #TDEE_definition{
            font-style: italic;
            color: gray;
            font-size: smaller;
            margin-top: -10px;
            margin-bottom: 10px;
            width: 90%;
            border-radius: 10px;
            padding: 20px;
        }
        #TDEE_result {
            font-weight: bold;
            font-size: medium;
            color: #f91616;
        }
        button {
            display: block;
            width: 60%;
            margin: 16px auto 0 auto;
            padding: 8px;
            background-color: rgb(228, 246, 240);
            border-radius: 5px;
            border:2px;
            cursor: pointer;
        }
        #out_TDEE_section{
            margin-top: 20px;
            text-align: left;
        }
        #out_TDEE_section h3{
            font-style: italic;
            font-size: 15px;
        }
        #workout_mode{
            display: block;
            margin: 8px auto;
            width: 60%;
            padding: 8px;
            border: 1px solid #ccc;
            border-radius: 3px;
            box-sizing: border-box;
            text-align: center;
        }
        .recommend_daily_str{
            color: #ff0000;
            font-weight: bold;
            font-style: italic;
            font-size: medium;
            margin-top: 20px;
            margin-bottom: 10px;
        }
        #muscular_nutrition, #slim_nutrition{
            margin-top: 10px;
            margin-bottom: 10px;
            display: none;
        }
        
    </style>
</head>
<body>
    <div class="result_container">
        <h2>TDEE Calculator</h2>
            <p id="TDEE_descrption">
                Firsy of all, we will estimate your Total Daily Energy Expenditure (TDEE) based on your input data.
            </p>
            <p id="TDEE_definition">
                *TDEE refers to the total number of calories you burn in a day, including <br>your basal metabolic rate (BMR) and physical activity.
            </p>
        <div class="result_container" id="out_TDEE_section">
            <h3>Your TDEE Result:</h3>
            <p id="TDEE_result"></p>
        </div>
    </div>
    <div class="mode_container">
        <h3>Next Step: Gym Route Generation</h3>
        <p id="mode_description">
            Based on your TDEE and fitness level, we will generate a recommended daily calories intake to your needs.
        </p>
        <p id="mode_selection">
            Please select your preferred workout mode:
        </p>
        <div id="mode_select_label">
        <label for='workout_mode'>Workout Mode:</label>
        <select name="workout_mode" id="workout_mode" required>
            <option value="" selected>Select your option</option>
            <option value="muscular">Muscular</option>
            <option value="weight_loss">Weight Loss</option>
        </select>
        </div>
        <div id="mode_info_muscular" style="display:none;">
            <h4>Muscular Mode</h4>
            <p>
                This mode focuses on building muscle mass and strength. It typically involves higher calorie intake and strength training exercises.
            </p>
        </div>
        <div id="mode_info_slim" style="display:none;">
            <h4>Slim Mode</h4>
            <p>
                This mode is designed for weight loss and fat reduction. It usually involves a calorie deficit and a combination of cardio and strength training exercises.
            </p>
        </div>
        <div id="energy_nutrition">
            <p class="recommend_daily_str" id="recommend_daily_input"></p>
            <h4>Diet Recommendation</h4>
            <div id="muscular_nutrition">
                <h4 class="muscular_mode">Muscular mode (muscle gain) = higher calorie, high protein, moderate carbs.</h4>
                <ul class="muscular_mode">Breakfast</ul>
                <li>Oatmeal (½ cup) with banana slices & honey</li>
                <li>3-4 egg whites + 1 whole egg omelette with veggies</li>
                <li>Glass of low-fat milk or protein shake</li>
                <ul class="muscular_mode">Lunch</ul>
                <li>Grilled turkey breast or lean beef (200g)</li>
                <li>Sweet potato (1 medium) or brown rice (1 cup)</li>  
                <li>Steamed green beans + mixed salad</li>
                <li>Olive oil & balsamic vinegar dressing</li>
                <ul class="muscular_mode">Dinner</ul>
                <li>Grilled salmon (150g) or tofu if vegetarian</li>
                <li>Quinoa or whole-grain pasta (1 cup)</li>
                <li>Roasted Brussels sprouts + carrots</li>
                <li>Side salad with mixed greens + light vinaigrette</li>
            </div>
            
            <div id="slim_nutrition">
            <h4 class="slim_mode">Slimming mode (fat loss) = lower calorie, high protein, nutrient dense.</h4>      
                <ul class="slim_mode">Breakfast</ul>
                    <li>Scrambled egg whites + 1 whole egg</li>
                    <li>Spinach & tomato sauté</li>
                    <li>1 slice whole‑grain toast</li>
                    <li>Black coffee or green tea</li>
                <ul class="slim_mode">Lunch</ul>
                    <li>Grilled chicken breast (150g)</li>
                    <li>Quinoa or brown rice (½ cup)</li>
                    <li>Roasted broccoli + carrots</li>
                    <li>Olive oil & lemon as dressing</li>
                <ul class="slim_mode">Dinner</ul>
                    <li>Baked salmon (120g) or tofu if vegetarian</li>
                    <li>Steamed zucchini & asparagus</li>
                    <li>Side salad with cucumber + light vinaigrette</li>
            </div>
            
        </div>
        <button id="to_routine" onclick="window.location.href='/routine'">Go To Routine Suggestion</button>
        <button id="to_gym_input" onclick="window.location.href='/'">Input data again</button>
    </div>
</body>
<script>
    function calculateTDEE({ gender, age, height, weight, fitness_level }) {
        age = Number(age);
        height = Number(height);
        weight = Number(weight);
        let bmr;
        if (gender === 'Male') {
            bmr = 10 * weight + 6.25 * height - 5 * age + 5;
        } else {
            bmr = 10 * weight + 6.25 * height - 5 * age - 161;
        }
        // Activity factor based on fitness level
        let activityFactor = 1.2; // Sedentary
        if (fitness_level === 'Beginner') activityFactor = 1.375;
        if (fitness_level === 'Intermediate') activityFactor = 1.55;
        if (fitness_level === 'Advanced') activityFactor = 1.725;
        return Math.round(bmr * activityFactor);
    }
    function energyintake(){
        const tdee = calculateTDEE(formData);
        const mode = document.getElementById('workout_mode').value;
        let intake;
        if(mode === 'muscular') {
            intake = Math.round(tdee * 1.2);
        } else if (mode === 'weight_loss') {
            intake = Math.round(tdee * 0.8);
        } else {
            intake = 0;}
        document.getElementById('recommend_daily_input').textContent = `Recommended Daily Energy Intake: ${intake} kcal/day.`;
    }
    function get_nutrition() {
        const mode = document.getElementById('workout_mode').value;
        if (mode === 'muscular') {
            document.getElementById('muscular_nutrition').style.display = 'block';
            document.getElementById('slim_nutrition').style.display = 'none';
        } else if (mode === 'weight_loss') {
            document.getElementById('slim_nutrition').style.display = 'block';
            document.getElementById('muscular_nutrition').style.display = 'none';
        } else{
            document.getElementById('muscular_nutrition').style.display = 'none';
            document.getElementById('slim_nutrition').style.display = 'none';
        }
    }
    const formData = JSON.parse(localStorage.getItem('gymFormData') || '{}');
    if (formData && formData.height && formData.weight && formData.age && formData.gender && formData.fitness_level) {
        const tdee = calculateTDEE(formData);
        document.getElementById('TDEE_result').textContent = `Your estimated TDEE is ${tdee} kcal/day.`;
    } else {
        document.getElementById('TDEE_result').textContent = 'Missing input data. Please go back and fill out the form.';
    }
    // Show/hide mode info based on workout_mode selection
    function updateModeInfo() {
        var mode = document.getElementById('workout_mode').value;
        var muscularDiv = document.getElementById('mode_info_muscular');
        var slimDiv = document.getElementById('mode_info_slim');
        if (mode === 'muscular') {
            muscularDiv.style.display = 'block';
            slimDiv.style.display = 'none';
        } else if (mode === 'weight_loss') {
            muscularDiv.style.display = 'none';
            slimDiv.style.display = 'block';
        } else {
            muscularDiv.style.display = 'none';
            slimDiv.style.display = 'none';
        }
    }
    document.getElementById('workout_mode').addEventListener('change', updateModeInfo);
    document.getElementById('workout_mode').addEventListener('change', energyintake);
    document.getElementById('workout_mode').addEventListener('change', get_nutrition);
    updateModeInfo();
</script>